---
permalink: admin/use-api-if-sso-is-enabled-entra-id.html 
sidebar: sidebar 
keywords: how to access storagegrid API if SSO is enabled with Entra ID 
summary: 'Wenn Sie Single Sign-On (SSO) konfiguriert und aktiviert haben und Entra ID als SSO-Anbieter verwenden, können Sie mithilfe von zwei Beispielskripten ein Authentifizierungstoken abrufen, das für die Grid Management API oder die Tenant Management API gültig ist.' 
---
= Verwenden Sie die API, wenn Single Sign-On aktiviert ist (Entra-ID).
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Wenn Sielink:../admin/how-sso-works.html["Konfiguration und Aktivierung von Single Sign On (SSO)"] und Sie Entra ID als SSO-Anbieter verwenden, können Sie zwei Beispielskripte verwenden, um ein Authentifizierungstoken zu erhalten, das für die Grid Management API oder die Tenant Management API gültig ist.



== Sign in , wenn die einmalige Anmeldung bei Entra ID aktiviert ist.

Diese Anweisungen gelten, wenn Sie Entra ID als SSO-Identitätsanbieter verwenden

.Bevor Sie beginnen
* Sie kennen die SSO E-Mail-Adresse und das Passwort für einen föderierten Benutzer, der zu einer StorageGRID Benutzergruppe gehört.
* Wenn Sie auf die Mandanten-Management-API zugreifen möchten, kennen Sie die Mandanten-Account-ID.


.Über diese Aufgabe
Um ein Authentifizierungs-Token zu erhalten, können Sie die folgenden Beispielskripte verwenden:

* Das `storagegrid-ssoauth-azure.py` Python-Skript
* Das `storagegrid-ssoauth-azure.js` Skript Node.js


Beide Skripte befinden sich im StorageGRID Installationsverzeichnis(`./rpms` für RHEL, `./debs` für Ubuntu oder Debian und `./vsphere` für VMware).

Informationen zum Schreiben Ihrer eigenen API-Integration mit Entra ID finden Sie im `storagegrid-ssoauth-azure.py` Skript.  Das Python-Skript sendet zwei Anfragen direkt an StorageGRID (zuerst, um die SAML-Anforderung abzurufen, und später, um das Autorisierungstoken abzurufen) und ruft außerdem das Node.js-Skript auf, um mit der Entra-ID zu interagieren und die SSO-Vorgänge durchzuführen.

SSO-Vorgänge können mithilfe einer Reihe von API-Anfragen ausgeführt werden, dies ist jedoch nicht ganz einfach.  Das Puppeteer Node.js-Modul wird zum Scrapen der Entra ID SSO-Schnittstelle verwendet.

Wenn Sie ein Problem mit der URL-Kodierung haben, wird möglicherweise der Fehler angezeigt: `Unsupported SAML version`.

.Schritte
. Installieren Sie die erforderlichen Abhängigkeiten:
+
.. Installieren Sie Node.js (siehe https://nodejs.org/en/download/["https://nodejs.org/en/download/"^]).
.. Installieren Sie die erforderlichen Node.js-Module (Puppenspieler und jsdom):
+
`npm install -g <module>`



. Übergeben Sie das Python-Skript an den Python-Interpreter, um das Skript auszuführen.
+
Das Python-Skript ruft dann das entsprechende Node.js-Skript auf, um die Entra ID SSO-Interaktionen durchzuführen.

. Geben Sie bei Aufforderung Werte für die folgenden Argumente ein (oder geben Sie diese mit Hilfe von Parametern weiter):
+
** Die SSO-E-Mail-Adresse, die zur Anmeldung bei Entra ID verwendet wird
** Die Adresse für StorageGRID
** Die Mandantenkonto-ID, wenn Sie auf die Mandantenmanagement-API zugreifen möchten


. Geben Sie bei der entsprechenden Aufforderung das Kennwort ein und seien Sie bereit, Entra ID auf Anfrage eine MFA-Autorisierung zu erteilen.
+
image::../media/sso_api_password_mfa.png[Aufforderung zur Eingabe von Passwort und MFA]

+

NOTE: Das Skript geht davon aus, dass MFA mithilfe von Microsoft Authenticator ausgeführt wird. Möglicherweise müssen Sie das Skript ändern, um andere Formen von MFA zu unterstützen (z. B. die Eingabe eines Codes, der in einer Textnachricht empfangen wird).

+
Das StorageGRID-Autorisierungs-Token wird in der Ausgabe bereitgestellt. Sie können das Token jetzt auch für andere Anforderungen verwenden. Dies entspricht der Verwendung der API, wenn SSO nicht verwendet wurde.


